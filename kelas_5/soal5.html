<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Matematika Kelas 5 (Paket 5) - MyWhatituS</title>
    <style>
        /* --- CSS SAMA SEPERTI TEMPLATE ASLI --- */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a2e;
            background-image: url('https://myonlineweb.github.io/basepng/malamback.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .container {
            width: 78%;
            max-width: 800px;
            margin: 40px 0;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.65);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .question-card {
            border-bottom: 2px solid #eee;
            padding-bottom: 25px;
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .options {
            list-style-type: none;
            padding: 0;
        }

        .option-btn {
            display: block;
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            background-color: #fff;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1em;
            color: #444;
            font-weight: 500;
        }

        .option-btn:hover:not(.disabled) {
            background-color: #eef2f3;
            border-color: #bbb;
            transform: translateX(5px);
        }

        .correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            color: #155724 !important;
        }

        .wrong {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            color: #721c24 !important;
        }

        .disabled {
            cursor: no-drop;
            opacity: 0.7;
        }

        .explanation {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #e8eaf6;
            border-left: 5px solid #3f51b5;
            border-radius: 4px;
            font-size: 0.95em;
            line-height: 1.5;
            color: #333;
        }

        .submit-container {
            text-align: center;
            margin: 40px 0 20px 0;
        }

        .btn-submit {
            padding: 15px 50px;
            font-size: 1.2em;
            font-weight: bold;
            color: white;
            background-color: #27ae60;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            opacity: 0.5;
            pointer-events: none;
            filter: grayscale(100%);
        }

        .btn-submit.active {
            opacity: 1;
            pointer-events: auto;
            filter: grayscale(0%);
            animation: pulse 2s infinite;
        }

        .btn-submit:hover {
            background-color: #219150;
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
            }

            70% {
                box-shadow: 0 0 0 20px rgba(39, 174, 96, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(39, 174, 96, 0);
            }
        }

        .score-board {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
            z-index: 100;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .spacer {
            height: 100px;
        }

        /* STYLE MODAL POPUP */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.show {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            transform: scale(0.7);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 3em;
            margin-bottom: 10px;
            animation: pop 0.5s;
        }

        .modal-content h2 {
            margin: 10px 0;
            color: #333;
        }

        .result-summary {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            gap: 10px;
        }

        .res-box {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            color: white;
            display: flex;
            flex-direction: column;
        }

        .res-box.correct {
            background: #27ae60;
        }

        .res-box.score {
            background: #2980b9;
            transform: scale(1.1);
            font-weight: bold;
        }

        .res-box.wrong {
            background: #c0392b;
        }

        .res-box .label {
            font-size: 0.8em;
            opacity: 0.9;
        }

        .res-box .val {
            font-size: 1.5em;
            font-weight: bold;
        }

        .btn-close {
            margin-top: 15px;
            padding: 10px 30px;
            background: #333;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1em;
        }

        .btn-close:hover {
            background: #000;
        }

        @keyframes pop {
            0% {
                transform: scale(0);
            }

            80% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        /* --- STYLE KHUSUS PASSWORD EYE --- */
        .password-wrapper {
            position: relative;
            /* Kunci agar icon bisa nempel relatif ke kotak ini */
            width: 100%;
            margin-bottom: 20px;
        }

        .password-wrapper input {
            width: 100%;
            padding: 15px;
            padding-right: 50px;
            /* PENTING: Kasih jarak kanan biar teks gak nabrak icon */
            border-radius: 10px;
            border: 2px solid #ddd;
            font-size: 1.1em;
            box-sizing: border-box;
        }

        .eye-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            /* Biar pas di tengah vertikal */
            cursor: pointer;
            color: #888;
            user-select: none;
            /* Biar icon gak ke-blok biru kalau diklik */
        }

        .eye-icon:hover {
            color: #333;
        }

        /* Tambahan Style untuk Warning */
        .modal-icon.warning {
            color: #f39c12;
            /* Warna Oranye/Kuning Peringatan */
            animation: shake 0.5s;
            /* Animasi getar */
        }

        /* Animasi Getar biar kerasa "Error" */
        @keyframes shake {
            0% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-10px);
            }

            50% {
                transform: translateX(10px);
            }

            75% {
                transform: translateX(-10px);
            }

            100% {
                transform: translateX(0);
            }
        }

        /* --- STYLE TOMBOL KEMBALI --- */
        .btn-back {
            display: inline-block;
            text-decoration: none;
            color: #fff;
            background-color: #e74c3c;
            /* Merah */
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 20px;
            /* Jarak ke judul */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, background-color 0.2s;
        }

        .btn-back:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }
    </style>
</head>

<body>

    <div class="container">
        <a href="index.html" class="btn-back">‚¨Ö Kembali</a>
        <h1>Kuis Matematika Kelas 5 (Paket 5)</h1>
        <div style="margin-bottom: 20px; max-width: 100%;">
            <input type="text" id="input-nama" placeholder="Ketik Username"
                style="width: 100%; padding: 15px; margin-bottom: 10px; border-radius: 10px; border: 2px solid #ddd; font-size: 1.1em; box-sizing: border-box;">
        </div>
        <div class="password-wrapper">
            <input type="password" id="input-password" placeholder="Ketik Password">

            <span id="btn-toggle-pass" class="eye-icon" title="Lihat Password">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
            </span>
        </div>
        <div id="quiz-area"></div>
        <div class="submit-container">
            <button id="btn-submit" class="btn-submit">SELESAIKAN SEMUA SOAL</button>
        </div>
        <div class="spacer"></div>
    </div>

    <div class="score-board">
        <span>‚úÖ Benar: <span id="score-correct">0</span></span>
        <span>‚ùå Salah: <span id="score-wrong">0</span></span>
    </div>

    <div id="custom-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-icon">üéâ</div>
            <h2>Hasil Terkirim!</h2>
            <p>Data jawabanmu sudah aman di database Firebase.</p>
            <div class="result-summary">
                <div class="res-box correct">
                    <span class="label">Benar</span>
                    <span class="val" id="modal-correct">0</span>
                </div>
                <div class="res-box score">
                    <span class="label">Nilai</span>
                    <span class="val" id="modal-score">0</span>
                </div>
                <div class="res-box wrong">
                    <span class="label">Salah</span>
                    <span class="val" id="modal-wrong">0</span>
                </div>
            </div>
            <button onclick="closeModal()" class="btn-close">Selesai</button>
        </div>
    </div>

    <div id="warning-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-icon warning">‚ö†Ô∏è</div>

            <h2 id="warning-title" style="color: #c0392b;">Ups, Tunggu Dulu!</h2>
            <p id="warning-message" style="color: #555; line-height: 1.6;">Ada input/password yang tidak sesuai nih!</p>

            <button onclick="closeWarning()" class="btn-close" style="background-color: #c0392b;">Perbaiki</button>
        </div>
    </div>

    <script>
        // --- DATA SOAL MATEMATIKA PAKET 5 ---
        let soal = [
            {
                "id": "0005",
                "pertanyaan": "Sebuah balok memiliki panjang 15 cm, lebar 10 cm, dan tinggi 8 cm. Berapa volume balok tersebut?",
                "pilihan": [
                    "1.000 cm¬≥",
                    "1.200 cm¬≥",
                    "1.500 cm¬≥",
                    "1.800 cm¬≥"
                ],
                "jawaban": "1.200 cm¬≥",
                "pembahasan": "Volume balok = p √ó l √ó t = 15 √ó 10 √ó 8 = 1.200 cm¬≥.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 5: Bangun Ruang"
            },
            {
                "id": "0006",
                "pertanyaan": "Sebuah akuarium berbentuk kubus dengan panjang rusuk 30 cm. Berapa liter air yang dapat ditampung akuarium tersebut?",
                "pilihan": [
                    "9 liter",
                    "27 liter",
                    "90 liter",
                    "270 liter"
                ],
                "jawaban": "27 liter",
                "pembahasan": "Volume = s √ó s √ó s = 30 √ó 30 √ó 30 = 27.000 cm¬≥ = 27 liter (1 liter = 1.000 cm¬≥).",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 5: Bangun Ruang"
            },
            {
                "id": "0007",
                "pertanyaan": "Perbandingan uang Andi dan Budi adalah 3 : 5. Jika uang Budi Rp75.000, berapa uang Andi?",
                "pilihan": [
                    "Rp35.000",
                    "Rp45.000",
                    "Rp50.000",
                    "Rp55.000"
                ],
                "jawaban": "Rp45.000",
                "pembahasan": "Uang Andi = (3/5) √ó 75.000 = 45.000. Jadi uang Andi adalah Rp45.000.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 6: Perbandingan dan Skala"
            },
            {
                "id": "0008",
                "pertanyaan": "Jarak kota A ke kota B pada peta adalah 8 cm. Jika skala peta 1 : 500.000, berapa km jarak sebenarnya?",
                "pilihan": [
                    "4 km",
                    "40 km",
                    "400 km",
                    "4.000 km"
                ],
                "jawaban": "40 km",
                "pembahasan": "Jarak sebenarnya = 8 √ó 500.000 = 4.000.000 cm = 40 km.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 6: Perbandingan dan Skala"
            },
            {
                "id": "0009",
                "pertanyaan": "Diagram batang menunjukkan penjualan buah: Apel 25, Jeruk 40, Mangga 35, Pisang 20. Buah apa yang paling banyak terjual?",
                "pilihan": [
                    "Apel",
                    "Jeruk",
                    "Mangga",
                    "Pisang"
                ],
                "jawaban": "Jeruk",
                "pembahasan": "Jeruk memiliki angka penjualan tertinggi yaitu 40 buah.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 7: Pengolahan Data"
            },
            {
                "id": "0010",
                "pertanyaan": "Nilai ulangan 8 siswa: 75, 80, 85, 70, 90, 80, 75, 85. Berapakah median dari data tersebut?",
                "pilihan": [
                    "75",
                    "80",
                    "82,5",
                    "85"
                ],
                "jawaban": "80",
                "pembahasan": "Data diurutkan: 70, 75, 75, 80, 80, 85, 85, 90. Median = (80+80)/2 = 80.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 7: Pengolahan Data"
            },
            {
                "id": "0011",
                "pertanyaan": "Sebuah kolam renang berbentuk balok dengan panjang 25 m, lebar 10 m, dan kedalaman 2 m. Berapa liter volume air dalam kolam jika terisi penuh?",
                "pilihan": [
                    "500 liter",
                    "5.000 liter",
                    "50.000 liter",
                    "500.000 liter"
                ],
                "jawaban": "500.000 liter",
                "pembahasan": "Volume = 25 √ó 10 √ó 2 = 500 m¬≥ = 500.000 liter (1 m¬≥ = 1.000 liter).",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 5: Bangun Ruang"
            },
            {
                "id": "0012",
                "pertanyaan": "Kecepatan sebuah sepeda motor adalah 60 km/jam. Berapa menit waktu yang diperlukan untuk menempuh jarak 30 km?",
                "pilihan": [
                    "20 menit",
                    "30 menit",
                    "40 menit",
                    "50 menit"
                ],
                "jawaban": "30 menit",
                "pembahasan": "Waktu = Jarak / Kecepatan = 30 / 60 = 0,5 jam = 30 menit.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "Bab 6: Perbandingan dan Skala"
            },
            {
                "id": "0013",
                "pertanyaan": "Hasil dari 2¬æ + 1‚Öì adalah ...",
                "pilihan": [
                    "3 7/12",
                    "4 1/12",
                    "3 11/12",
                    "4 2/12"
                ],
                "jawaban": "4 1/12",
                "pembahasan": "2¬æ + 1‚Öì = 11/4 + 4/3 = 33/12 + 16/12 = 49/12 = 4 1/12.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UTS (Pecahan)"
            },
            {
                "id": "0014",
                "pertanyaan": "Hasil dari 4/5 : 2/3 adalah ...",
                "pilihan": [
                    "8/15",
                    "6/5",
                    "12/10",
                    "6/15"
                ],
                "jawaban": "6/5",
                "pembahasan": "4/5 : 2/3 = 4/5 √ó 3/2 = 12/10 = 6/5.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UTS (Pecahan)"
            },
            {
                "id": "0015",
                "pertanyaan": "FPB dari 36 dan 48 adalah ...",
                "pilihan": [
                    "6",
                    "8",
                    "12",
                    "24"
                ],
                "jawaban": "12",
                "pembahasan": "36 = 2¬≤ √ó 3¬≤, 48 = 2‚Å¥ √ó 3. FPB = 2¬≤ √ó 3 = 4 √ó 3 = 12.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UTS (FPB dan KPK)"
            },
            {
                "id": "0016",
                "pertanyaan": "Luas permukaan balok dengan panjang 12 cm, lebar 8 cm, dan tinggi 5 cm adalah ...",
                "pilihan": [
                    "392 cm¬≤",
                    "480 cm¬≤",
                    "296 cm¬≤",
                    "592 cm¬≤"
                ],
                "jawaban": "392 cm¬≤",
                "pembahasan": "Luas = 2(pl + pt + lt) = 2(96 + 60 + 40) = 2 √ó 196 = 392 cm¬≤.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UAS (Bangun Ruang)"
            },
            {
                "id": "0017",
                "pertanyaan": "Sebuah keran air memiliki debit 15 liter/menit. Berapa liter air yang mengalir selama 12 menit?",
                "pilihan": [
                    "150 liter",
                    "180 liter",
                    "200 liter",
                    "120 liter"
                ],
                "jawaban": "180 liter",
                "pembahasan": "Volume = Debit √ó Waktu = 15 √ó 12 = 180 liter.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UAS (Debit)"
            },
            {
                "id": "0018",
                "pertanyaan": "Rata-rata nilai ulangan 5 siswa adalah 78. Jika nilai siswa keenam ditambahkan, rata-rata menjadi 80. Berapa nilai siswa keenam?",
                "pilihan": [
                    "88",
                    "90",
                    "85",
                    "92"
                ],
                "jawaban": "90",
                "pembahasan": "Total 5 siswa = 5 √ó 78 = 390. Total 6 siswa = 6 √ó 80 = 480. Nilai ke-6 = 480 - 390 = 90.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UAS (Statistika)"
            },
            {
                "id": "0019",
                "pertanyaan": "Sebuah taman berbentuk persegi panjang dengan panjang 50 m dan lebar 30 m akan dipasang pagar keliling. Biaya pemasangan pagar Rp25.000/meter. Berapa total biaya yang diperlukan?",
                "pilihan": [
                    "Rp3.000.000",
                    "Rp4.000.000",
                    "Rp3.750.000",
                    "Rp4.500.000"
                ],
                "jawaban": "Rp4.000.000",
                "pembahasan": "Keliling = 2(50 + 30) = 160 m. Biaya = 160 √ó 25.000 = Rp4.000.000.",
                "kelas": "5",
                "mapel": "Matematika",
                "kategori": "UAS (Soal Cerita)"
            }
        ];

        // Gunakan variabel dataSoal untuk kompatibilitas dengan engine
        let dataSoal = soal;

        // --- SYSTEM ENGINE ---
        const quizArea = document.getElementById('quiz-area');
        const scoreCorrectEl = document.getElementById('score-correct');
        const scoreWrongEl = document.getElementById('score-wrong');
        const btnSubmitGame = document.getElementById('btn-submit');

        var correctCount = 0;
        var wrongCount = 0;
        var answeredCount = 0;

        function renderQuiz() {
            quizArea.innerHTML = '';
            dataSoal.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';

                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerText = (index + 1) + ". " + item.pertanyaan; // Tambah nomor soal
                card.appendChild(qText);

                const optList = document.createElement('ul');
                optList.className = 'options';

                item.pilihan.forEach((opt, optIndex) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt;
                    btn.onclick = () => checkAnswer(btn, item, opt, optList, explanationDiv);
                    optList.appendChild(btn);
                });

                card.appendChild(optList);

                const explanationDiv = document.createElement('div');
                explanationDiv.className = 'explanation';
                explanationDiv.innerHTML = `<strong>Jawaban Benar:</strong> ${item.jawaban}<br><em>${item.pembahasan}</em>`;
                card.appendChild(explanationDiv);

                quizArea.appendChild(card);
            });
        }

        function checkAnswer(selectedBtn, dataItem, selectedText, optListContainer, expDiv) {
            if (optListContainer.classList.contains('answered')) return;

            optListContainer.classList.add('answered');
            answeredCount++;

            const allBtns = optListContainer.querySelectorAll('.option-btn');
            allBtns.forEach(btn => btn.classList.add('disabled'));

            if (selectedText === dataItem.jawaban) {
                selectedBtn.classList.add('correct');
                correctCount++;
                scoreCorrectEl.innerText = correctCount;
            } else {
                selectedBtn.classList.add('wrong');
                wrongCount++;
                scoreWrongEl.innerText = wrongCount;
                // Highlight correct answer
                const correctBtn = Array.from(allBtns).find(b => b.innerText === dataItem.jawaban);
                if (correctBtn) correctBtn.classList.add('correct');
            }

            expDiv.style.display = 'block';
            checkCompletion();
        }

        function checkCompletion() {
            if (answeredCount === dataSoal.length) {
                btnSubmitGame.classList.add('active');
                btnSubmitGame.innerText = "KIRIM JAWABAN SEKARANG!";
            }
        }

        renderQuiz();

        const toggleBtn = document.getElementById('btn-toggle-pass');
        const passInput = document.getElementById('input-password');

        toggleBtn.addEventListener('click', () => {
            const type = passInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passInput.setAttribute('type', type);
            toggleBtn.style.color = type === 'text' ? '#27ae60' : '#888';
        });

    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getFirestore, collection, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCrGo4oJqVPesVBDd52-OGT2sHFNdeI5jo",
            authDomain: "mywhatitu.firebaseapp.com",
            projectId: "mywhatitu",
            storageBucket: "mywhatitu.firebasestorage.app",
            messagingSenderId: "756121162482",
            appId: "1:756121162482:web:3fbc2d0e26f70e51b6f66b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- KONFIGURASI SOAL PAKET 5 ---
        const KODE_SOAL = "soal5_mtk_kls5"; // Kode unik untuk paket 5
        const KELAS = "5";
        const MAPEL = "Matematika";

        const btnSubmitFirebase = document.getElementById('btn-submit');

        btnSubmitFirebase.addEventListener('click', async () => {
            if (!btnSubmitFirebase.classList.contains('active')) return;

            const nama = document.getElementById('input-nama').value.trim();
            const password = document.getElementById('input-password').value.trim();

            if (!nama || !password) {
                showWarning("Nama dan Password Kosong!", "Mohon isi Username dan Password terlebih dahulu.");
                return;
            }

            // Validasi password
            const userRef = doc(db, "users", nama);
            const userSnap = await getDoc(userRef);

            if (!userSnap.exists()) {
                showWarning("User Tidak Ditemukan!", "Username yang kamu masukkan tidak terdaftar.");
                return;
            }

            if (userSnap.data().password !== password) {
                showWarning("Password Salah!", "Password yang kamu masukkan tidak sesuai.");
                return;
            }

            // Hitung skor
            const totalSoal = dataSoal.length;
            const nilaiAkhir = Math.round((correctCount / totalSoal) * 100);

            // Simpan hasil ke Firebase
            const hasilRef = doc(db, "hasil_kuis", `${nama}_${KODE_SOAL}`);
            await setDoc(hasilRef, {
                nama: nama,
                kelas: KELAS,
                mapel: MAPEL,
                kode_soal: KODE_SOAL,
                benar: correctCount,
                salah: wrongCount,
                nilai: nilaiAkhir,
                waktu_submit: new Date().toISOString()
            });

            // Tampilkan modal sukses
            document.getElementById('modal-correct').innerText = correctCount;
            document.getElementById('modal-wrong').innerText = wrongCount;
            document.getElementById('modal-score').innerText = nilaiAkhir;
            document.getElementById('custom-modal').classList.add('show');

            // Disable tombol setelah submit
            btnSubmitFirebase.classList.remove('active');
            btnSubmitFirebase.innerText = "SUDAH TERKIRIM ‚úì";
            btnSubmitFirebase.style.backgroundColor = "#7f8c8d";
        });

        // Fungsi untuk menampilkan warning modal
        window.showWarning = function (title, message) {
            document.getElementById('warning-title').innerText = title;
            document.getElementById('warning-message').innerText = message;
            document.getElementById('warning-modal').classList.add('show');
        }

        // Fungsi untuk menutup warning modal
        window.closeWarning = function () {
            document.getElementById('warning-modal').classList.remove('show');
        }

        // Fungsi untuk menutup modal sukses
        window.closeModal = function () {
            document.getElementById('custom-modal').classList.remove('show');
        }
    </script>

</body>

</html>